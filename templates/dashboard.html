{% extends "base.html" %}
{% block content %}

<h2>Expenses Dashboard</h2>

<h3>Total Expenses</h3>
<p>{{ total_expenses }}</p>

<h3>Filter by Merchant</h3>
<form action="/filter_merchant" method="POST">
    <select name="merchant_id">
        {% for merchant in merchants %}
        <option value ="{{ merchant.get_merchant_id() }}">{{ merchant.get_merchant_name() }}</option>
        {% endfor %}
    </select>
    <input type="submit" value="Filter">
</form>
<p>Expenses filtered by Merchant: {{subtotal_expenses_merchant}}</p>

<h3>Filter by Category</h3>
<form action="/filter_category" method="POST">
    <select name="category_id">
        {% for category in categories %}
        <option value ="{{ category.id }}">{{ category.name }}</option>
        {% endfor %}
    </select>
    <input type="submit" value="Filter">
</form>
<p>Expenses filtered by Category: {{subtotal_expenses_category}}</p>

<h3>Detailed Expenses</h3>
{% for expense in expenses %}

<section>
    <p>Transaction date: {{ expense.get_expense_date() }}</p>
    <p>{{ expense.get_expense_description() }}</p>
    <p>Merchant: {{ expense.merchant.get_merchant_name() }}</p>
    <p>Category: {{ expense.category.get_category_name() }}</p>
    <p>Amount: {{ expense.get_expense_amount() }}</p>
    <a href="/{{ expense.id }}/edit">Edit</a>
    <form action="/{{ expense.id }}/delete" method="POST">
        <input type="submit" value="Delete">
    </form>
</section>
<hr>

{% endfor %}
<p><a href="/">Register a new Expense</a></p>
{% endblock %}